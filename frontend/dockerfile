
FROM node:18-bullseye

ARG NEXT_PUBLIC_EXPLORER_URL
ARG NEXT_PUBLIC_DAPP_URL
ARG NEXT_PUBLIC_AUDIT_TRAIL_PKG
ARG NEXT_PUBLIC_REFRESH_INTERVAL_MS
ARG NEXT_PUBLIC_REWARD_WHITELIST_ID
ARG NEXT_PUBLIC_ADMIN_CAP_ID
ARG BACKEND_ENDPOINT
ARG BACKEND_API_KEY
ARG GAS_STATION_URL
ARG GAS_STATION_AUTH
ARG NEXT_PUBLIC_HAS_REWARD
ARG NEXT_PUBLIC_NETWORK
ARG NEXT_PUBLIC_PRODUCT_ID

ENV NEXT_PUBLIC_EXPLORER_URL=$NEXT_PUBLIC_EXPLORER_URL
ENV NEXT_PUBLIC_DAPP_URL=$NEXT_PUBLIC_DAPP_URL
ENV NEXT_PUBLIC_AUDIT_TRAIL_PKG=$NEXT_PUBLIC_AUDIT_TRAIL_PKG
ENV NEXT_PUBLIC_REWARD_WHITELIST_ID=$NEXT_PUBLIC_REWARD_WHITELIST_ID
ENV NEXT_PUBLIC_ADMIN_CAP_ID=$NEXT_PUBLIC_ADMIN_CAP_ID
ENV NEXT_PUBLIC_REFRESH_INTERVAL_MS=$NEXT_PUBLIC_REFRESH_INTERVAL_MS
ENV BACKEND_ENDPOINT=$BACKEND_ENDPOINT
ENV BACKEND_API_KEY=$BACKEND_API_KEY
ENV GAS_STATION_URL=$GAS_STATION_URL
ENV GAS_STATION_AUTH=$GAS_STATION_AUTH
ENV NEXT_PUBLIC_HAS_REWARD=$NEXT_PUBLIC_HAS_REWARD
ENV NEXT_PUBLIC_NETWORK=$NEXT_PUBLIC_NETWORK
ENV NEXT_PUBLIC_PRODUCT_ID=$NEXT_PUBLIC_PRODUCT_ID

WORKDIR /usr/src/app

COPY package*.json ./
RUN npm install

COPY . .

RUN npm run build

EXPOSE 3000

CMD ["npm", "start"]
